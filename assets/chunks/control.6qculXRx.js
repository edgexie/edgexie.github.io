import{m as b}from"./mqtt.esm.NaeEf8Ew.js";import{a as v}from"./utils.VTZxRdCg.js";import{d as k,h as i,A as x,D as l,o as y,c as q,k as I,a as r,I as o,w as c,t as N,F as B}from"./framework.FXFKkhX9.js";const E=k({__name:"control",setup(C){const p="emqx_vue3_"+Math.random().toString(16).substring(2,8),{username:m,password:_}=v(),t=b.connect("wss://seab0915.ala.cn-hangzhou.emqxsl.cn:8084/mqtt",{clientId:p,username:m,password:_});t.on("connect",()=>{t.subscribe("esp8266/will",e=>{e&&console.log(e)}),t.subscribe("led/status",e=>{e&&console.log(e)})}),t.on("message",(e,n)=>{const s=n.toString();switch(console.log(e,s),e){case"esp8266/will":a.value=s=="online";break;case"led/status":u.value=JSON.parse(s).status}});const u=i(!1),a=i(!1),g=e=>{t.publish("led/ctl",e?"open":"close")};return x(()=>{console.log("取消订阅"),t.end()}),(e,n)=>{const s=l("a-typography-text"),d=l("a-col"),f=l("a-switch"),h=l("a-row");return y(),q(B,null,[I("div",null,[r(" 设备状态： "),o(s,{type:a.value?"success":"danger"},{default:c(()=>[r(N(a.value?"在线":"离线"),1)]),_:1},8,["type"])]),o(h,{gutter:16},{default:c(()=>[o(d,null,{default:c(()=>[r(" LED ")]),_:1}),o(d,null,{default:c(()=>[o(f,{checked:u.value,"onUpdate:checked":n[0]||(n[0]=w=>u.value=w),onClick:g,disabled:!a.value},null,8,["checked","disabled"])]),_:1})]),_:1})],64)}}});export{E as default};
